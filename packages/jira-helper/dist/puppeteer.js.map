{"version":3,"sources":["puppeteer.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,6BAA6B;AAC7B,gDAAwB;AACxB,oEAAiC;AACjC,kDAAwB;AACxB,MAAM,GAAG,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;AAEvD,IAAI,WAAW,GAAG,KAAK,CAAC;AAExB,SAAgB,cAAc,CAAC,GAAY;IACzC,WAAW,GAAG,GAAG,CAAC;AACpB,CAAC;AAFD,wCAEC;AACD,uBAAuB;AACvB,SAAsB,KAAK;;QACzB,MAAM,OAAO,GAAG,MAAM,MAAM,EAAE,CAAC;QAC/B,MAAM,KAAK,GAAG,MAAM,OAAO,CAAC,KAAK,EAAE,CAAC;QACpC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,oBAAoB,EACtC,EAAC,OAAO,EAAE,CAAC,EAAE,SAAS,EAAE,kBAAkB,EAAC,CAAC,CAAC;IACjD,CAAC;CAAA;AALD,sBAKC;AAED,SAAsB,MAAM,CAAC,QAAQ,GAAG,KAAK;;QAC3C,IAAI,cAAsB,CAAC;QAE3B,QAAQ,OAAO,CAAC,QAAQ,EAAE;YACxB,kGAAkG;YAClG,KAAK,QAAQ;gBACX,cAAc,GAAG,8DAA8D,CAAC;gBAChF,MAAM;YACR,KAAK,OAAO;gBACV,cAAc,GAAG,cAAI,CAAC,OAAO,CAC7B,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,IAAI,wBAAwB,EAAE,sCAAsC,CAAC,CAAC;gBACtG,MAAM;YACR;gBACE,MAAM,GAAG,GAAG,6CAA6C,GAAG,OAAO,CAAC,QAAQ,CAAC;gBAC7E,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACf,MAAM,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC;SACxB;QACD,IAAI,WAAW,KAAK,IAAI,EAAE;YACxB,GAAG,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;YACjC,QAAQ,GAAG,IAAI,CAAC;SACjB;QACD,MAAM,OAAO,GAAG,MAAM,wBAAG,CAAC,MAAM,CAAC;YAC/B,QAAQ;YACR,cAAc,EAAE,cAAe;YAC/B,WAAW,EAAE,eAAG,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,EAAE,gBAAgB,CAAC;YAC5D,iBAAiB,EAAE,IAAI;YACvB,eAAe,EAAE,EAAC,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,EAAC;SAC5C,CAAC,CAAC;QACH,OAAO,OAAO,CAAC;IACjB,CAAC;CAAA;AA7BD,wBA6BC;AAED,SAAgB,IAAI;IAClB,OAAO,CAAC,GAAG,CAAC,eAAG,CAAC,IAAI,CAAC,CAAC;AACxB,CAAC;AAFD,oBAEC;AAED,SAAsB,SAAS,CAAC,EAAqB;;QACnD,IAAI,EAAE,IAAI,IAAI;YACZ,OAAO,KAAK,CAAC;QACf,MAAM,GAAG,GAAG,MAAM,EAAE,CAAC,WAAW,EAAE,CAAC;QACnC,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,IAAI,GAAG,CAAC,KAAK,GAAG,CAAC;YAChD,OAAO,KAAK,CAAC;QACf,OAAO,IAAI,CAAC;IACd,CAAC;CAAA;AAPD,8BAOC;AAED,SAAsB,cAAc,CAAC,EAAqB,EAAE,OAAO,GAAG,IAAI,EAAE,OAAO,GAAG,KAAK;;QACzF,MAAM,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QACnC,OAAO,IAAI,EAAE;YACX,MAAM,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC;YACvD,IAAI,CAAC,MAAM,SAAS,CAAC,EAAE,CAAC,CAAC,KAAK,OAAO;gBACnC,MAAM;YACR,IAAI,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,KAAK,GAAG,OAAO,EAAE;gBAC1C,MAAM,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC;aAC5B;SACF;IACH,CAAC;CAAA;AAVD,wCAUC","file":"puppeteer.js","sourcesContent":["// tslint:disable: no-console\nimport Path from 'path';\nimport pup from 'puppeteer-core';\nimport api from '__api';\nconst log = require('log4js').getLogger('jira-helper');\n\nlet useHeadless = false;\n\nexport function setUseHeadless(yes: boolean) {\n  useHeadless = yes;\n}\n// import os from 'os';\nexport async function login() {\n  const browser = await launch();\n  const pages = await browser.pages();\n  await pages[0].goto('https://trello.com',\n    {timeout: 0, waitUntil: 'domcontentloaded'});\n}\n\nexport async function launch(headless = false): Promise<pup.Browser> {\n  let executablePath: string;\n\n  switch (process.platform) {\n    // Refer to https://chromium.googlesource.com/chromium/src/+/master/docs/user_data_dir.md#Mac-OS-X\n    case 'darwin':\n      executablePath = '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome';\n      break;\n    case 'win32':\n      executablePath = Path.resolve(\n      process.env['ProgramFiles(x86)'] || 'c:/Program Files (x86)', 'Google/Chrome/Application/chrome.exe');\n      break;\n    default:\n      const msg = 'jira-helper does not support this platform ' + process.platform;\n      log.error(msg);\n      throw new Error(msg);\n  }\n  if (useHeadless === true) {\n    log.info('Enable headless mode');\n    headless = true;\n  }\n  const browser = await pup.launch({\n    headless,\n    executablePath: executablePath!,\n    userDataDir: api.config.resolve('destDir', 'puppeteer-temp'),\n    ignoreHTTPSErrors: true,\n    defaultViewport: {width: 1236, height: 768}\n  });\n  return browser;\n}\n\nexport function main() {\n  console.log(api.argv);\n}\n\nexport async function isVisible(el: pup.ElementHandle) {\n  if (el == null)\n    return false;\n  const box = await el.boundingBox();\n  if (box == null || box.height < 5 || box.width < 5)\n    return false;\n  return true;\n}\n\nexport async function waitForVisible(el: pup.ElementHandle, visible = true, timeout = 30000) {\n  const begin = new Date().getTime();\n  while (true) {\n    await new Promise(resolve => setTimeout(resolve, 150));\n    if ((await isVisible(el)) === visible)\n      break;\n    if (new Date().getTime() - begin > timeout) {\n      throw new Error('timeout');\n    }\n  }\n}\n"]}